/disk/junlin/EmoSp/bart-our/-LIGHT-TRANS4/all_loss0.6_0.2_0.2_kl-lr_2e-05-Situ-Emoin-nopp-empp-no_fuse-bart-eosemo-role-emocat-stgcat-vae-mvae256-wo_comet-frz_stem124_II
vocab size = 50265
without comet
evaluating
vocab size = 50265
without comet
Testing: 2it [00:01,  1.94it/s]
encoder_kwargs dict_keys(['attention_mask', 'comet_embs', 'comet_mask', 'comet_embs_st', 'comet_mask_st', 'situation_hidden_states', 'situation_attention_mask', 'emo_dist', 'emo_in_dist', 'output_mutual_attentions', 'strat_positions', 'emo_positions', 'intensity', 'role_ids', 'output_attentions', 'output_hidden_states'])
k=attention_mask
v=tensor([[True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True]], device='cuda:0')
k=comet_embs
v=None
k=comet_mask
v=None
k=comet_embs_st
v=None
k=comet_mask_st
v=None
k=situation_hidden_states
v=tensor([[[-0.0314,  0.0206, -0.0106,  ...,  0.0082, -0.0169, -0.0046],
         [ 0.4333,  0.2636,  0.0960,  ..., -0.1127, -0.1092,  0.3945],
         [ 0.3458,  0.0115, -0.1696,  ..., -0.0393, -0.0054,  0.0079],
         ...,
         [ 0.0281,  0.2598,  0.3750,  ..., -0.3134, -0.3576,  0.0620],
         [ 0.1409,  0.0708, -0.0158,  ..., -0.1380, -0.2470,  0.3308],
         [-0.0586,  0.2050,  0.4368,  ..., -0.0368, -0.0945,  0.2261]]],
       device='cuda:0')
k=situation_attention_mask
v=tensor([[True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True]], device='cuda:0')
k=output_mutual_attentions
v=False
k=strat_positions
v=tensor([[  8,  69, 116, 163, 202, 255, 320, 389, 426]], device='cuda:0')
k=emo_positions
v=tensor([[ 42,  92, 141, 176, 223, 279, 369, 403, 446]], device='cuda:0')
k=intensity
v=tensor([[0.6298, 0.5013, 0.5555]], device='cuda:0')
k=role_ids
v=tensor([[    1, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50284, 50284, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283]],
       device='cuda:0')
k=output_attentions
v=False
k=output_hidden_states
v=False
k=emo_out_dist
v=tensor([[5.0613e-03, 2.6452e-04, 6.7103e-04, 1.1170e-03, 6.8730e-03, 1.5101e-01,
         5.5334e-04, 7.5503e-04, 8.9263e-03, 3.8655e-04, 1.2343e-03, 2.0163e-04,
         9.7425e-05, 1.6976e-03, 5.7264e-04, 2.7568e-01, 3.4126e-04, 2.5505e-03,
         1.4828e-03, 3.0130e-04, 5.3121e-01, 7.5383e-04, 6.7313e-04, 1.3442e-03,
         1.5143e-03, 6.0477e-04, 3.0879e-04, 3.8149e-03]], device='cuda:0',
       dtype=torch.float64)
You are welcome.
{'ref strategy': '[Providing Suggestions or Information]', 'hyp strategy': '[Reflection of feelings]'}
encoder_kwargs dict_keys(['attention_mask', 'comet_embs', 'comet_mask', 'comet_embs_st', 'comet_mask_st', 'situation_hidden_states', 'situation_attention_mask', 'emo_dist', 'emo_in_dist', 'output_mutual_attentions', 'strat_positions', 'emo_positions', 'intensity', 'role_ids', 'output_attentions', 'output_hidden_states'])
k=attention_mask
v=tensor([[True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True]],
       device='cuda:0')
k=comet_embs
v=None
k=comet_mask
v=None
k=comet_embs_st
v=None
k=comet_mask_st
v=None
k=situation_hidden_states
v=tensor([[[-0.0321,  0.0182, -0.0099,  ...,  0.0072, -0.0165, -0.0032],
         [ 0.3955,  0.4928, -0.1253,  ..., -0.0173, -0.2360,  0.5465],
         [ 0.1643,  0.3198, -0.1888,  ..., -0.1054, -0.1931,  0.1722],
         ...,
         [-0.1827,  0.0106,  0.0073,  ..., -0.2813, -0.1049,  0.1206],
         [ 0.1120,  0.1986,  0.0515,  ..., -0.1004, -0.2983,  0.1556],
         [ 0.1211,  0.3375,  0.0446,  ...,  0.0056, -0.1892,  0.3178]]],
       device='cuda:0')
k=situation_attention_mask
v=tensor([[True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True]], device='cuda:0')
k=output_mutual_attentions
v=False
k=strat_positions
v=tensor([], device='cuda:0', size=(1, 0), dtype=torch.int64)
k=emo_positions
v=tensor([[93]], device='cuda:0')
k=intensity
v=tensor([[0.5543, 0.4613, 0.4700]], device='cuda:0')
k=role_ids
v=tensor([[    1, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283]], device='cuda:0')
k=output_attentions
v=False
k=output_hidden_states
v=False
k=emo_out_dist
v=tensor([[8.5472e-04, 1.0138e-03, 1.3080e-03, 2.6855e-03, 4.0921e-03, 1.1823e-02,
         1.1703e-02, 4.1781e-02, 2.3943e-03, 1.3108e-02, 3.4638e-03, 8.1359e-04,
         3.1723e-03, 7.1463e-04, 1.3594e-03, 1.8498e-03, 2.0761e-03, 8.1911e-04,
         2.4508e-03, 4.5229e-03, 3.0745e-03, 1.0759e-04, 2.8292e-03, 6.0020e-04,
         7.3418e-01, 1.4166e-01, 6.4674e-04, 4.8979e-03]], device='cuda:0',
       dtype=torch.float64)
I' m sorry to hear that. I' m sure you are feeling lonely.
{'ref strategy': '[Question]', 'hyp strategy': '[Question]'}
encoder_kwargs dict_keys(['attention_mask', 'comet_embs', 'comet_mask', 'comet_embs_st', 'comet_mask_st', 'situation_hidden_states', 'situation_attention_mask', 'emo_dist', 'emo_in_dist', 'output_mutual_attentions', 'strat_positions', 'emo_positions', 'intensity', 'role_ids', 'output_attentions', 'output_hidden_states'])
k=attention_mask
v=tensor([[True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True, True, True, True, True, True]],
       device='cuda:0')
k=comet_embs
v=None
k=comet_mask
v=None
k=comet_embs_st
v=None
k=comet_mask_st
v=None
k=situation_hidden_states
v=tensor([[[-0.0306,  0.0194, -0.0107,  ...,  0.0083, -0.0163, -0.0030],
         [ 0.4185,  0.5181, -0.0036,  ..., -0.0837,  0.0517,  0.3087],
         [ 0.5356,  0.5854, -0.1311,  ..., -0.1856,  0.1105,  0.2357],
         ...,
         [ 0.1097,  0.3537,  0.1575,  ...,  0.0048, -0.0679, -0.1824],
         [ 0.1547,  0.2372,  0.0962,  ..., -0.0581, -0.3116,  0.1488],
         [ 0.0959,  0.3472,  0.0691,  ..., -0.0539, -0.1944,  0.4151]]],
       device='cuda:0')
k=situation_attention_mask
v=tensor([[True, True, True, True, True, True, True, True, True, True, True, True,
         True, True, True, True, True, True, True]], device='cuda:0')
k=output_mutual_attentions
v=False
k=strat_positions
v=tensor([[ 14,  33,  47,  72, 118]], device='cuda:0')
k=emo_positions
v=tensor([[  5,  24,  39,  58,  99, 130]], device='cuda:0')
k=intensity
v=tensor([[0.5967, 0.4146, 0.4734]], device='cuda:0')
k=role_ids
v=tensor([[    1, 50283, 50283, 50283, 50283, 50283, 50283, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50284, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50283, 50283, 50283, 50283, 50283,
         50283, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284, 50284,
         50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283, 50283,
         50283, 50283]], device='cuda:0')
k=output_attentions
v=False
k=output_hidden_states
v=False
k=emo_out_dist
v=tensor([[3.2258e-03, 4.8706e-04, 2.7263e-03, 2.1793e-02, 1.5487e-02, 1.2784e-02,
         1.0337e-01, 4.9506e-01, 2.9862e-03, 1.0625e-01, 8.2425e-03, 1.7140e-03,
         3.9497e-03, 4.6463e-03, 1.1301e-02, 3.4997e-04, 2.9042e-03, 1.6353e-03,
         2.8272e-03, 4.7676e-02, 3.2608e-03, 2.2367e-04, 9.4868e-03, 1.4691e-03,
         5.5634e-03, 8.6946e-02, 9.0178e-03, 3.4614e-02]], device='cuda:0',
