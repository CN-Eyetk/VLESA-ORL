/disk/junlin/EmoSp/bart-our/-LIGHT-TRANS4/all_loss0.6_0.2_0.2_kl-lr_2e-05-Emoin-nopp-empp-ensitu-desitu-vae-mvae256-wo_comet-vad124_II
vocab size = 50265
Some weights of BartForConditionalGeneration were not initialized from the model checkpoint at facebook/bart-base and are newly initialized: ['encoder.layers.0.attn_layer_norm_comet.weight', 'encoder.layers.0.attn_layer_norm_comet.bias', 'encoder.layers.1.attn_layer_norm_comet.weight', 'encoder.layers.1.attn_layer_norm_comet.bias', 'encoder.layers.2.attn_layer_norm_comet.weight', 'encoder.layers.2.attn_layer_norm_comet.bias', 'encoder.layers.3.attn_layer_norm_comet.weight', 'encoder.layers.3.attn_layer_norm_comet.bias', 'encoder.layers.4.attn_layer_norm_comet.weight', 'encoder.layers.4.attn_layer_norm_comet.bias', 'encoder.layers.5.attn_layer_norm_comet.weight', 'encoder.layers.5.attn_layer_norm_comet.bias', 'encoder.layers.5.muAttn.k_proj.weight', 'encoder.layers.5.muAttn.k_proj.bias', 'encoder.layers.5.muAttn.v_proj.weight', 'encoder.layers.5.muAttn.v_proj.bias', 'encoder.layers.5.muAttn.q_proj.weight', 'encoder.layers.5.muAttn.q_proj.bias', 'encoder.layers.5.muAttn.out_proj.weight', 'encoder.layers.5.muAttn.out_proj.bias', 'encoder.emotion_head.weight', 'encoder.emotion_head.bias', 'encoder.batchNorm_emotion.weight', 'encoder.batchNorm_emotion.bias', 'encoder.batchNorm_emotion.running_mean', 'encoder.batchNorm_emotion.running_var', 'encoder.batchNorm_strategy.weight', 'encoder.batchNorm_strategy.bias', 'encoder.batchNorm_strategy.running_mean', 'encoder.batchNorm_strategy.running_var', 'encoder.strategy_embedding.weight', 'encoder.multi_state_LayerNorm.weight', 'encoder.multi_state_LayerNorm.bias', 'encoder.strategy_head.weight', 'encoder.strategy_head.bias', 'encoder.trans_mat.emotion_embedding.weight', 'encoder.trans_mat.h_prior_emo.weight', 'encoder.trans_mat.h_prior_emo.bias', 'encoder.trans_mat.h_prior_strat.weight', 'encoder.trans_mat.h_prior_strat.bias', 'encoder.trans_mat.mu_prior.weight', 'encoder.trans_mat.mu_prior.bias', 'encoder.trans_mat.logvar_prior.weight', 'encoder.trans_mat.logvar_prior.bias', 'encoder.trans_mat.Dense_z_prior.weight', 'encoder.trans_mat.Dense_z_prior.bias', 'encoder.trans_mat.h_posterior_emo.weight', 'encoder.trans_mat.h_posterior_emo.bias', 'encoder.trans_mat.h_posterior_strat.weight', 'encoder.trans_mat.h_posterior_strat.bias', 'encoder.trans_mat.mu_posterior.weight', 'encoder.trans_mat.mu_posterior.bias', 'encoder.trans_mat.logvar_posterior.weight', 'encoder.trans_mat.logvar_posterior.bias', 'encoder.strat_cat_attn.V', 'encoder.strat_cat_attn.W.weight', 'encoder.emo_cat_attn.V', 'encoder.emo_cat_attn.W.weight', 'decoder.layers.0.encoder_attn_layer_norm_strategy.weight', 'decoder.layers.0.encoder_attn_layer_norm_strategy.bias', 'decoder.layers.0.encoder_attn_layer_norm_comet.weight', 'decoder.layers.0.encoder_attn_layer_norm_comet.bias', 'decoder.layers.0.encoder_attn_layer_norm_total.weight', 'decoder.layers.0.encoder_attn_layer_norm_total.bias', 'decoder.layers.1.encoder_attn_layer_norm_strategy.weight', 'decoder.layers.1.encoder_attn_layer_norm_strategy.bias', 'decoder.layers.1.encoder_attn_layer_norm_comet.weight', 'decoder.layers.1.encoder_attn_layer_norm_comet.bias', 'decoder.layers.1.encoder_attn_layer_norm_total.weight', 'decoder.layers.1.encoder_attn_layer_norm_total.bias', 'decoder.layers.2.encoder_attn_layer_norm_strategy.weight', 'decoder.layers.2.encoder_attn_layer_norm_strategy.bias', 'decoder.layers.2.encoder_attn_layer_norm_comet.weight', 'decoder.layers.2.encoder_attn_layer_norm_comet.bias', 'decoder.layers.2.encoder_attn_layer_norm_total.weight', 'decoder.layers.2.encoder_attn_layer_norm_total.bias', 'decoder.layers.3.encoder_attn_layer_norm_strategy.weight', 'decoder.layers.3.encoder_attn_layer_norm_strategy.bias', 'decoder.layers.3.encoder_attn_layer_norm_comet.weight', 'decoder.layers.3.encoder_attn_layer_norm_comet.bias', 'decoder.layers.3.encoder_attn_layer_norm_total.weight', 'decoder.layers.3.encoder_attn_layer_norm_total.bias', 'decoder.layers.4.encoder_attn_layer_norm_strategy.weight', 'decoder.layers.4.encoder_attn_layer_norm_strategy.bias', 'decoder.layers.4.encoder_attn_layer_norm_comet.weight', 'decoder.layers.4.encoder_attn_layer_norm_comet.bias', 'decoder.layers.4.encoder_attn_layer_norm_total.weight', 'decoder.layers.4.encoder_attn_layer_norm_total.bias', 'decoder.layers.5.encoder_attn_layer_norm_strategy.weight', 'decoder.layers.5.encoder_attn_layer_norm_strategy.bias', 'decoder.layers.5.encoder_attn_layer_norm_comet.weight', 'decoder.layers.5.encoder_attn_layer_norm_comet.bias', 'decoder.layers.5.encoder_attn_layer_norm_total.weight', 'decoder.layers.5.encoder_attn_layer_norm_total.bias', 'fuse_st_emo.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
  0%|                                                                                                                 | 0/510 [00:00<?, ?it/s]
without comet
BartConfig {
  "_name_or_path": "facebook/bart-base",
  "activation_dropout": 0.1,
  "activation_function": "gelu",
  "add_bias_logits": false,
  "add_emo_cross_attn": false,
  "add_final_layer_norm": false,
  "architectures": [
    "BartModel"
  ],
  "attention_dropout": 0.1,
  "bos_token_id": 0,
  "classif_dropout": 0.1,
  "classifier_dropout": 0.0,
  "d_model": 768,
  "decoder_attention_heads": 12,
  "decoder_ffn_dim": 3072,
  "decoder_layerdrop": 0.0,
  "decoder_layers": 6,
  "decoder_start_token_id": 2,
  "dropout": 0.1,
  "early_stopping": true,
  "emo_from_eos": true,
  "emo_from_situ": false,
  "emo_loss_ratio": 0.2,
  "emo_out_loss_ratio": 0.2,
  "emo_use_cat_attn": true,
  "encoder_attention_heads": 12,
  "encoder_ffn_dim": 3072,
  "encoder_layerdrop": 0.0,
  "encoder_layers": 6,
  "eos_token_id": 2,
  "force_bos_token_to_be_generated": false,
  "forced_bos_token_id": 0,
  "forced_eos_token_id": 2,
  "gradient_checkpointing": false,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1",
    "2": "LABEL_2"
  },
  "init_std": 0.02,
  "intensity_vae": false,
  "is_encoder_decoder": true,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1,
    "LABEL_2": 2
  },
  "latent_dim": 256,
  "lstm_st_seq": false,
  "max_position_embeddings": 1024,
  "merge": false,
  "mixed_vae": true,
  "model_type": "bart",
  "n_emo_out": 28,
  "no_fuse": true,
  "no_repeat_ngram_size": 3,
  "normalize_before": false,
  "normalize_embedding": true,
  "num_beams": 4,
  "num_hidden_layers": 6,
  "pad_token_id": 1,
  "prepend": false,
  "rl_emb_ratio": 0.6,
  "sample_strat_emb": false,
  "scale_embedding": false,
  "st_from_eos": true,
  "stg_use_cat_attn": true,
  "task_specific_params": {
    "summarization": {
      "length_penalty": 1.0,
      "max_length": 128,
      "min_length": 12,
      "num_beams": 4
    },
    "summarization_cnn": {
      "length_penalty": 2.0,
      "max_length": 142,
      "min_length": 56,
      "num_beams": 4
    },
    "summarization_xsum": {
      "length_penalty": 1.0,
      "max_length": 62,
      "min_length": 11,
      "num_beams": 6
    }
  },
  "torch_dtype": "float32",
  "transformers_version": "4.2.2",
  "use_cache": true,
  "use_copy": false,
  "use_emb_prep": true,
  "use_emo_in_dist": true,
  "use_kl": true,
  "use_role_embed": true,
  "use_situ_in_decoder": true,
  "use_situ_in_encoder": true,
  "use_st_seq": false,
  "use_th_attn": false,
  "use_trans_mat": true,
  "use_vad_labels": true,
  "use_vae": true,
  "vad_emb_ratio": 0.2,
  "vocab_size": 50265,
  "wo_comet": true,
  "wo_emo": false,
  "wo_stra": false
}
args.local_rank =  -1
162,803,592 total parameters.
162,803,592 training parameters.
contrast_loss tensor(2.8113, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6598, device='cuda:0', grad_fn=<MeanBackward0>)

  1%|▌                                                                                                        | 3/510 [00:02<05:35,  1.51it/s]
contrast_loss tensor(2.8043, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.7964, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6280, device='cuda:0', grad_fn=<MeanBackward0>)

  1%|█▏                                                                                                       | 6/510 [00:03<04:56,  1.70it/s]
contrast_loss tensor(2.6631, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.7897, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.9581, device='cuda:0', grad_fn=<MeanBackward0>)

  2%|██▏                                                                                                     | 11/510 [00:06<04:24,  1.89it/s]
contrast_loss tensor(2.4905, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6392, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6343, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.7960, device='cuda:0', grad_fn=<MeanBackward0>)

  3%|███                                                                                                     | 15/510 [00:08<03:44,  2.20it/s]
contrast_loss tensor(2.9525, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.5215, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.9465, device='cuda:0', grad_fn=<MeanBackward0>)

  4%|████                                                                                                    | 20/510 [00:10<03:42,  2.20it/s]
contrast_loss tensor(2.6554, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.5390, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.8022, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6454, device='cuda:0', grad_fn=<MeanBackward0>)


  6%|█████▉                                                                                                  | 29/510 [00:14<03:26,  2.32it/s]
contrast_loss tensor(2.3855, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.8041, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6427, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6535, device='cuda:0', grad_fn=<MeanBackward0>)

  7%|██████▉                                                                                                 | 34/510 [00:16<03:25,  2.32it/s]
contrast_loss tensor(2.6593, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.9515, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6636, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6444, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.9482, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.5952, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.8012, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.5280, device='cuda:0', grad_fn=<MeanBackward0>)

  7%|███████▋                                                                                                | 38/510 [00:18<03:22,  2.34it/s]
contrast_loss tensor(2.5209, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6455, device='cuda:0', grad_fn=<MeanBackward0>)


  9%|█████████▍                                                                                              | 46/510 [00:22<03:38,  2.13it/s]
contrast_loss tensor(2.9433, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.8114, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.5276, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.8043, device='cuda:0', grad_fn=<MeanBackward0>)

 10%|██████████▏                                                                                             | 50/510 [00:24<03:37,  2.12it/s]
contrast_loss tensor(2.5167, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.5022, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.8056, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.9564, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.9499, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6593, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.7984, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.8506, device='cuda:0', grad_fn=<MeanBackward0>)

 11%|███████████▏                                                                                            | 55/510 [00:26<03:19,  2.28it/s]
contrast_loss tensor(2.7952, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.5107, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.8144, device='cuda:0', grad_fn=<MeanBackward0>)

 12%|████████████                                                                                            | 59/510 [00:28<03:19,  2.26it/s]
contrast_loss tensor(2.7976, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.7664, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6599, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.5177, device='cuda:0', grad_fn=<MeanBackward0>)

 13%|█████████████                                                                                           | 64/510 [00:30<03:11,  2.33it/s]
contrast_loss tensor(2.8285, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6686, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.4952, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.7912, device='cuda:0', grad_fn=<MeanBackward0>)

 14%|██████████████                                                                                          | 69/510 [00:32<03:11,  2.30it/s]
contrast_loss tensor(2.8129, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.8034, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.5180, device='cuda:0', grad_fn=<MeanBackward0>)

 14%|██████████████▉                                                                                         | 73/510 [00:34<03:25,  2.13it/s]
contrast_loss tensor(2.9540, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6752, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6557, device='cuda:0', grad_fn=<MeanBackward0>)

 15%|███████████████▉                                                                                        | 78/510 [00:36<03:16,  2.20it/s]
contrast_loss tensor(2.7917, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.7996, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6437, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6648, device='cuda:0', grad_fn=<MeanBackward0>)

 16%|████████████████▋                                                                                       | 82/510 [00:38<03:02,  2.35it/s]
contrast_loss tensor(2.5175, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.4959, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6463, device='cuda:0', grad_fn=<MeanBackward0>)

 17%|█████████████████▋                                                                                      | 87/510 [00:40<03:14,  2.17it/s]
contrast_loss tensor(2.5084, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.5311, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.5181, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.5012, device='cuda:0', grad_fn=<MeanBackward0>)


 19%|███████████████████▌                                                                                    | 96/510 [00:44<03:01,  2.28it/s]
contrast_loss tensor(2.3709, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.5108, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.8261, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.9521, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.7996, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.5158, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.7987, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6640, device='cuda:0', grad_fn=<MeanBackward0>)


 21%|█████████████████████▏                                                                                 | 105/510 [00:48<03:08,  2.15it/s]
contrast_loss tensor(2.8005, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.3784, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.2450, device='cuda:0', grad_fn=<MeanBackward0>)

 21%|██████████████████████                                                                                 | 109/510 [00:50<02:59,  2.23it/s]
contrast_loss tensor(2.9587, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.8015, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.7229, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.8282, device='cuda:0', grad_fn=<MeanBackward0>)

 22%|██████████████████████▊                                                                                | 113/510 [00:52<03:05,  2.14it/s]
contrast_loss tensor(2.9483, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.5729, device='cuda:0', grad_fn=<MeanBackward0>)

 23%|███████████████████████▋                                                                               | 117/510 [00:54<03:02,  2.16it/s]
contrast_loss tensor(2.5109, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.8178, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6554, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(2.6742, device='cuda:0', grad_fn=<MeanBackward0>)

 24%|████████████████████████▍                                                                              | 121/510 [00:56<03:01,  2.14it/s]
contrast_loss tensor(nan, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(nan, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(nan, device='cuda:0', grad_fn=<MeanBackward0>)

 25%|█████████████████████████▏                                                                             | 125/510 [00:58<02:52,  2.23it/s]
contrast_loss tensor(nan, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(nan, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(nan, device='cuda:0', grad_fn=<MeanBackward0>)

 25%|██████████████████████████▎                                                                            | 130/510 [01:00<02:55,  2.16it/s]
contrast_loss tensor(nan, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(nan, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(nan, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(nan, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(nan, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(nan, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(nan, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(nan, device='cuda:0', grad_fn=<MeanBackward0>)

 26%|███████████████████████████▎                                                                           | 135/510 [01:02<02:47,  2.24it/s]
contrast_loss tensor(nan, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(nan, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(nan, device='cuda:0', grad_fn=<MeanBackward0>)
contrast_loss tensor(nan, device='cuda:0', grad_fn=<MeanBackward0>)

