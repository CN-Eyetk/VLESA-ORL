/disk/junlin/EmoSp/bart-our/-LIGHT-TRANS4/all_loss0.2_0.2_0.2_kl-lr_2e-05-Situ-Emoin-nopp-empp-no_fuse-bart-eosemo-role-emocat-stgcat-vae256-wo_comet-vad-frz_stem124_II
vocab size = 50265
10192 10192 10192
[(0, 0), (0, 5), (5, 6), (7, 10), (11, 13), (14, 18), (19, 23), (24, 26), (27, 32), (33, 38), (38, 39), (0, 0)]
  0%|                                                                                                                         | 0/10191 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/lijunlin/lijunlin/ESCONV/main.py", line 316, in <module>
    train_dataset, eval_dataset, test_dataset = load_dataset(args, tokenizer)
  File "/home/lijunlin/lijunlin/ESCONV/main.py", line 279, in load_dataset
    train_dataset = load_and_cache_examples(args, tokenizer, df_trn, comet_trn, st_comet_trn, evaluate=False, strategy=args.strategy, situations = st_trn)
  File "/home/lijunlin/lijunlin/ESCONV/BlenderEmotionalSupport.py", line 1019, in load_and_cache_examples
    return ESDDataset(tokenizer, args, df, comet, comet_st, evaluate=evaluate, strategy=strategy, test=test, situations = situations, vad_tokenizer = vad_tokenizer)
  File "/home/lijunlin/lijunlin/ESCONV/BlenderEmotionalSupport.py", line 785, in __init__
    conv = construct_conv_ESD(args, idx, row, comet_row, comet_st_row, tokenizer, cls=False, strategy=strategy ,evaluate=evaluate, situation = situations[idx], prepend_emotion = args.prepend_emotion, use_emo_in_dist = args.use_emo_in_dist, vad_tokenizer = vad_tokenizer)
  File "/home/lijunlin/lijunlin/ESCONV/BlenderEmotionalSupport.py", line 716, in construct_conv_ESD
    inputs, roles, turns, strategy_labels, _, _, emo_in_dist, _, vad_ids= _get_inputs_from_text("EOS".join(row.split("EOS")[:-1]), tokenizer, strategy=strategy, get_emo_dist = False, get_emo_in_dist = (True if use_emo_in_dist else False),
  File "/home/lijunlin/lijunlin/ESCONV/BlenderEmotionalSupport.py", line 669, in _get_inputs_from_text
    vad_id = tokenizer.convert_tokens_to_ids(vad_labels)
  File "/home/lijunlin/lijunlin/ESCONV/src/transformers/tokenization_utils.py", line 376, in convert_tokens_to_ids
    ids.append(self._convert_token_to_id_with_added_voc(token))
  File "/home/lijunlin/lijunlin/ESCONV/src/transformers/tokenization_utils.py", line 383, in _convert_token_to_id_with_added_voc
    if token in self.added_tokens_encoder:
TypeError: unhashable type: 'list'