/disk/junlin/EmoSp/bart-our/-LIGHT-TRANS4/all_loss0.2_0.2_0.2_kl-lr_2e-05-Situ-Emoin-nopp-empp-no_fuse-bart-eosemo-role-emocat-stgcat-vae256-wo_comet-vad-frz_stem124_II
vocab size = 50265
10192 10192 10192
[(0, 0), (0, 5), (5, 6), (7, 10), (11, 13), (14, 18), (19, 23), (24, 26), (27, 32), (33, 38), (38, 39), (0, 0)]
vad_labels ['[0v0a0d]', '[0v0a0d]', '[0v0a0d]', '[+v-a+d3]', '[0v0a0d]', '[+v-a+d1]', '[0v0a0d]', '[+v-a+d3]', '[+v-a-d3]', '[0v0a0d]']
[(0, 0), (0, 5), (5, 6), (7, 8), (9, 14), (15, 19), (20, 22), (23, 27), (28, 30), (31, 38), (39, 44), (45, 47), (48, 57), (58, 60), (61, 65), (65, 66), (0, 0)]
vad_labels ['[0v0a0d]', '[0v0a0d]', '[0v0a0d]', '[-v-a-d1]', '[+v-a-d2]', '[0v0a0d]', '[+v-a+d3]', '[0v0a0d]', '[0v0a0d]', '[0v0a0d]', '[0v0a0d]', '[+v-a+d1]', '[0v0a0d]', '[+v+a+d3]', '[0v0a0d]']
[(0, 0), (0, 1), (2, 6), (7, 10), (11, 15), (16, 23), (24, 26), (27, 31), (32, 34), (34, 35), (36, 40), (41, 43), (44, 48), (49, 58), (59, 61), (62, 66), (67, 71), (71, 72), (0, 0)]
vad_labels ['[0v0a0d]', '[+v-a-d2]', '[0v0a0d]', '[+v+a-d3]', '[0v0a0d]', '[0v0a0d]', '[+v-a+d3]', '[0v0a0d]', '[0v0a0d]', '[0v0a0d]', '[+v-a+d3]', '[0v0a0d]', '[+v-a+d1]', '[0v0a0d]', '[0v0a0d]', '[+v+a+d3]', '[0v0a0d]']
[(0, 0), (0, 3), (4, 7), (8, 11), (12, 17), (18, 25), (25, 26), (0, 0)]
vad_labels ['[0v0a0d]', '[+v-a+d3]', '[0v0a0d]', '[+v+a+d1]', '[0v0a0d]', '[0v0a0d]']
[(0, 0), (0, 3), (4, 6), (7, 12), (12, 13), (0, 0)]
vad_labels ['[0v0a0d]', '[0v0a0d]', '[+v+a+d4]', '[0v0a0d]']
[(0, 0), (0, 2), (3, 7), (8, 11), (12, 15), (16, 19), (20, 23), (24, 29), (29, 30), (31, 34), (35, 38), (39, 48), (48, 49), (0, 0)]
vad_labels ['[0v0a0d]', '[0v0a0d]', '[-v-a-d2]', '[+v-a+d3]', '[0v0a0d]', '[0v0a0d]', '[+v+a+d4]', '[0v0a0d]', '[+v-a-d2]', '[0v0a0d]', '[+v-a+d2]', '[0v0a0d]']
[(0, 0), (0, 1), (2, 4), (5, 8), (9, 14), (15, 22), (23, 25), (26, 28), (29, 36), (37, 44), (45, 49), (50, 52), (52, 56), (56, 59), (59, 60), (0, 0)]
vad_labels ['[0v0a0d]', '[+v-a+d3]', '[0v0a0d]', '[+v+a+d4]', '[0v0a0d]', '[0v0a0d]', '[0v0a0d]', '[+v-a+d2]', '[-v+a-d3]', '[0v0a0d]', '[0v0a0d]', '[0v0a0d]', '[0v0a0d]', '[0v0a0d]']
[(0, 0), (0, 3), (3, 8), (9, 14), (15, 20), (21, 23), (24, 37), (38, 42), (43, 59), (60, 64), (65, 71), (72, 77), (78, 80), (81, 85), (85, 86), (0, 0)]
vad_labels ['[-v+a-d4]', '[-v+a-d4]', '[0v0a0d]', '[+v+a+d3]', '[0v0a0d]', '[+v+a+d3]', '[0v0a0d]', '[-v+a-d3]', '[0v0a0d]', '[-v-a-d3]', '[-v-a-d3]', '[0v0a0d]', '[+v-a+d4]', '[0v0a0d]']
[(0, 0), (0, 4), (5, 6), (7, 13), (14, 16), (17, 22), (23, 27), (28, 30), (31, 47), (48, 50), (51, 55), (56, 58), (59, 62), (63, 69), (69, 70), (71, 74), (75, 77), (78, 82), (83, 85), (86, 90), (91, 95), (96, 104), (104, 105), (106, 108), (109, 112), (113, 115), (116, 120), (121, 127), (128, 130), (131, 138), (139, 143), (143, 144), (0, 0)]
vad_labels ['[0v0a0d]', '[0v0a0d]', '[+v-a+d4]', '[0v0a0d]', '[0v0a0d]', '[+v-a+d3]', '[+v-a+d3]', '[-v+a-d3]', '[0v0a0d]', '[+v+a+d2]', '[0v0a0d]', '[+v+a+d3]', '[+v-a+d2]', '[0v0a0d]', '[0v0a0d]', '[0v0a0d]', '[-v-a-d1]', '[+v-a+d3]', '[0v0a0d]', '[-v-a-d2]', '[+v-a+d2]', '[0v0a0d]', '[0v0a0d]', '[0v0a0d]', '[0v0a0d]', '[+v-a+d3]', '[+v-a+d3]', '[0v0a0d]', '[-v+a-d3]', '[0v0a0d]', '[0v0a0d]']
[(0, 0), (0, 1), (2, 12), (13, 18), (19, 23), (24, 27), (27, 28), (29, 32), (33, 38), (39, 52), (53, 55), (56, 59), (60, 64), (64, 65), (0, 0)]
vad_labels ['[0v0a0d]', '[+v-a+d3]', '[+v-a+d4]', '[0v0a0d]', '[0v0a0d]', '[0v0a0d]', '[+v-a-d2]', '[0v0a0d]', '[+v+a+d3]', '[+v+a+d1]', '[0v0a0d]', '[+v+a+d3]', '[0v0a0d]']
[(0, 0), (0, 3), (4, 6), (7, 11), (12, 16), (17, 19), (20, 23), (23, 24), (0, 0)]
  0%|                                                                                                               | 1/10191 [00:01<4:18:49,  1.52s/it]
Traceback (most recent call last):
  File "/home/lijunlin/lijunlin/ESCONV/main.py", line 316, in <module>
    train_dataset, eval_dataset, test_dataset = load_dataset(args, tokenizer)
  File "/home/lijunlin/lijunlin/ESCONV/main.py", line 279, in load_dataset
    train_dataset = load_and_cache_examples(args, tokenizer, df_trn, comet_trn, st_comet_trn, evaluate=False, strategy=args.strategy, situations = st_trn)
  File "/home/lijunlin/lijunlin/ESCONV/BlenderEmotionalSupport.py", line 1020, in load_and_cache_examples
    return ESDDataset(tokenizer, args, df, comet, comet_st, evaluate=evaluate, strategy=strategy, test=test, situations = situations, vad_tokenizer = vad_tokenizer)
  File "/home/lijunlin/lijunlin/ESCONV/BlenderEmotionalSupport.py", line 786, in __init__
    conv = construct_conv_ESD(args, idx, row, comet_row, comet_st_row, tokenizer, cls=False, strategy=strategy ,evaluate=evaluate, situation = situations[idx], prepend_emotion = args.prepend_emotion, use_emo_in_dist = args.use_emo_in_dist, vad_tokenizer = vad_tokenizer)
  File "/home/lijunlin/lijunlin/ESCONV/BlenderEmotionalSupport.py", line 717, in construct_conv_ESD
    inputs, roles, turns, strategy_labels, _, _, emo_in_dist, _, vad_ids= _get_inputs_from_text("EOS".join(row.split("EOS")[:-1]), tokenizer, strategy=strategy, get_emo_dist = False, get_emo_in_dist = (True if use_emo_in_dist else False),
  File "/home/lijunlin/lijunlin/ESCONV/BlenderEmotionalSupport.py", line 656, in _get_inputs_from_text
    context_id_new, tokens, vad_labels = vad_tokenizer.tokenizer_vad(vad_input
  File "/home/lijunlin/lijunlin/ESCONV/attach_vad/VADTokenizer.py", line 122, in tokenizer_vad
    res.append((ids[i], self.tokenizer.convert_ids_to_tokens(ids[i]), token_vad[0]))
IndexError: list index out of range