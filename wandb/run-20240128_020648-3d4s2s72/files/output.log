/disk/junlin/EmoSp/bart-our/-LIGHT-TRANS4/all_loss0.6_0.2_0.2_kl-lr_2e-05-Situ-Emoin-nopp-empp-no_fuse-bart-eosemo-role-emocat-stgcat-vae-mvae256-wo_comet-frz_stem124_II
vocab size = 50265
without comet
vocab size = 50265
without comet
Testing: 0it [00:01, ?it/s]
Traceback (most recent call last):
  File "/home/lijunlin/lijunlin/ESCONV/main.py", line 340, in <module>
    generate(args)
  File "/home/lijunlin/lijunlin/ESCONV/BlenderEmotionalSupport.py", line 1646, in generate
    situ_hidden = model.model.encoder(situ_ids, attention_mask=situ_ids.ne(tokenizer.pad_token_id))[0]
  File "/home/lijunlin/miniconda3/envs/empchat/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/lijunlin/miniconda3/envs/empchat/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/lijunlin/lijunlin/ESCONV/src/transformers/models/bart/modeling_bart.py", line 980, in forward
    inputs_embeds = self.embed_tokens(input_ids) * self.embed_scale
  File "/home/lijunlin/miniconda3/envs/empchat/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/lijunlin/miniconda3/envs/empchat/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/lijunlin/miniconda3/envs/empchat/lib/python3.10/site-packages/torch/nn/modules/sparse.py", line 162, in forward
    return F.embedding(
  File "/home/lijunlin/miniconda3/envs/empchat/lib/python3.10/site-packages/torch/nn/functional.py", line 2233, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)