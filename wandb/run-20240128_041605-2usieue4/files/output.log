
  0%|                                                                                                                                          | 0/10191 [00:00<?, ?it/s]
/disk/junlin/EmoSp/bart-our/-LIGHT-TRANS4/all_loss0.6_0.2_0.2_kl-lr_2e-05-Situ-Emoin-nopp-empp-no_fuse-bart-eosemo-role-emocat-stgcat-vae-mvae256-wo_comet-vad-frz_stem124_II
vocab size = 50265
10192 10192 10192
tokens= ['Hello', ',', 'Ġhow', 'Ġis', 'Ġyour', 'Ġhead', 'Ġor', 'Ġheart', 'Ġtoday', '?']
words= ['Hello', ',', 'how', 'is', 'your', 'head', 'or', 'heart', 'today', '?']
vad_labels 11
context_id 11
tokens 10
vad_input Hello, how is your head or heart today?
tokens= ['Hello', ',', 'ĠI', 'Ġwould', 'Ġlike', 'Ġto', 'Ġtalk', 'Ġto', 'Ġsomeone', 'Ġabout', 'Ġmy', 'Ġsituation', 'Ġat', 'Ġwork', '.']
words= ['Hello', ',', 'I', 'would', 'like', 'to', 'talk', 'to', 'someone', 'about', 'my', 'situation', 'at', 'work', '.']
vad_labels 16
context_id 16
tokens 15
vad_input Hello, I would like to talk to someone about my situation at work.
tokens= ['I', 'Ġhear', 'Ġyou', 'Ġneed', 'Ġsomeone', 'Ġto', 'Ġtalk', 'Ġto', '.', 'ĠWhat', 'Ġis', 'Ġyour', 'Ġsituation', 'Ġat', 'Ġyour', 'Ġwork', '?']
words= ['I', 'hear', 'you', 'need', 'someone', 'to', 'talk', 'to', '.', 'What', 'is', 'your', 'situation', 'at', 'your', 'work', '?']
vad_labels 18
context_id 18
tokens 17
  0%|                                                                                                                                          | 0/10191 [00:01<?, ?it/s]
Traceback (most recent call last):
  File "/home/lijunlin/lijunlin/ESCONV/main.py", line 316, in <module>
    train_dataset, eval_dataset, test_dataset = load_dataset(args, tokenizer)
  File "/home/lijunlin/lijunlin/ESCONV/main.py", line 279, in load_dataset
    train_dataset = load_and_cache_examples(args, tokenizer, df_trn, comet_trn, st_comet_trn, evaluate=False, strategy=args.strategy, situations = st_trn)
  File "/home/lijunlin/lijunlin/ESCONV/BlenderEmotionalSupport.py", line 996, in load_and_cache_examples
    return ESDDataset(tokenizer, args, df, comet, comet_st, evaluate=evaluate, strategy=strategy, test=test, situations = situations, vad_tokenizer = vad_tokenizer)
  File "/home/lijunlin/lijunlin/ESCONV/BlenderEmotionalSupport.py", line 762, in __init__
    conv = construct_conv_ESD(args, idx, row, comet_row, comet_st_row, tokenizer, cls=False, strategy=strategy ,evaluate=evaluate, situation = situations[idx], prepend_emotion = args.prepend_emotion, use_emo_in_dist = args.use_emo_in_dist, vad_tokenizer = vad_tokenizer)
  File "/home/lijunlin/lijunlin/ESCONV/BlenderEmotionalSupport.py", line 708, in construct_conv_ESD
    feature = _make_feature(args, idx, inputs, roles, turns, tokenizer.eos_token_id, tokenizer.pad_token_id, pad=pad, strategy_labels=strategy_labels, situ_ids = situ_ids, evaluate=evaluate, str_embd=True, generation=generation, vad_ids = vad_ids)
  File "/home/lijunlin/lijunlin/ESCONV/BlenderEmotionalSupport.py", line 433, in _make_feature
    assert len(input_ids) == len(vad_ids)
AssertionError